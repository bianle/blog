<!DOCTYPE html>
<html>
<head>
<meta http-equiv=Content-Type content="text/html;charset=utf-8">
<script src="/common/js/codemirror/lib/codemirror.js"></script>
<link rel="stylesheet" href="/common/js/codemirror/lib/codemirror.css">
<script src="/common/js/codemirror/mode/xml/xml.js"></script>
<script src="/common/js/codemirror/mode/css/css.js"></script>
<script src="/common/js/codemirror/mode/javascript/javascript.js"></script>
<script src="/common/js/codemirror/mode/htmlmixed/htmlmixed.js"></script>
<script type="text/javascript" src="/common/js/jquery.js"></script>
<style>

</style>
</head>
<body>
  <div id="src" style="">
     {{content}}
  </div>
</body>
<script>

  var cms = new Array();

 $(".highlight").each(function(index){
     var $codediv = $("<div id='codediv"+index+"'><div>");
     var $codeArea = $("<textarea width='400' id='codeArea"+index+"'><textarea>");
     $codediv.html($codeArea);
     $codeArea.html($(this).find("code").html());
     $codediv.append("<input type=\"button\" onclick=\"runCode("+index+")\" value=\"运行\"></input>");
     $(this).replaceWith($codediv);

     var obj = CodeMirror.fromTextArea(document.getElementById("codeArea"+index),{
      lineNumbers: true,
      mode: "htmlmixed"
     });
     cms.push(obj);
 });

//$("#src").show();

 function runCode(ind){
    var winname = window.open('', "_blank", '');
    var content =cms[ind].doc.getValue();
    winname.document.open('text/html', 'replace');
    winname.opener = null
    winname.document.writeln(content);
    winname.document.close();
 }


</script>
</html>
