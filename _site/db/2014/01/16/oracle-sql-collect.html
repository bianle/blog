<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>知無涯</title>

    <link rel="stylesheet" href="/themes/modernist/stylesheets/styles.css">
    <link rel="stylesheet" href="/themes/modernist/stylesheets/pygment_trac.css">
    <script src="/themes/modernist/javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
      <h1><a href="/">知無涯</a></h1>
        <p>生有涯，知無涯</p>
        <ul>
          <li><a href="https://github.com/bianle/blog/tree/gh-pages">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a name="welcome-to-github-pages" class="anchor" href="#welcome-to-github-pages"><span class="octicon octicon-link"></span></a> oracle SQL 收集 
        </h1>

    <h3>主键自增</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="cm">/*1.新建索引*/</span>
<span class="k">CREATE</span> <span class="n">SEQUENCE</span> <span class="n">SEQ_FOR_TB1</span>
<span class="k">INCREMENT</span> <span class="k">BY</span> <span class="mi">1</span> <span class="cm">/*-– 每次加几个*/</span>
<span class="k">START</span> <span class="k">WITH</span> <span class="mi">1</span> <span class="cm">/*-– 从1开始计数*/</span>
<span class="n">NOMAXVALUE</span> <span class="cm">/*-– 不设置最大值*/</span>
<span class="n">NOCYCLE</span> <span class="cm">/*-– 一直累加，不循环*/</span>
<span class="k">CACHE</span> <span class="mi">10</span><span class="p">;</span>
<span class="cm">/*2.增加触发器*/</span>
<span class="k">CREATE</span> <span class="k">TRIGGER</span> <span class="n">TB1_AUTO_PK</span> <span class="k">BEFORE</span>
<span class="k">insert</span> <span class="k">ON</span> <span class="n">t_tb</span> <span class="k">FOR</span> <span class="k">EACH</span> <span class="k">ROW</span>
<span class="k">begin</span>
<span class="k">select</span> <span class="n">SEQ_FOR_TB1</span><span class="p">.</span><span class="n">nextval</span> <span class="k">into</span><span class="p">:</span><span class="k">New</span><span class="p">.</span><span class="n">ID</span> <span class="k">from</span> <span class="n">dual</span><span class="p">;</span>
<span class="k">end</span><span class="p">;</span>
</code></pre></div>
<h3>正则表达式</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">REGEXP_REPLACE</span><span class="p">(</span><span class="s1">&#39;[1,2,3]99990.0[%]&#39;</span><span class="p">,</span><span class="s1">&#39;\[[^\[]*\]&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">dual</span><span class="p">;</span> 
</code></pre></div>
<h3>分析函数</h3>

<ul>
<li>SYS<em>CONNECT</em>BY_PATH</li>
</ul>

<p>分组求和，文字类型以逗号拼接</p>

<p>|  |ND   |XL  |BZ|
|--|-----|----|---|
|1 |2012 |100 |苹果|
|2 |2013 |200 |苹果|
|3 |2014 |300 |苹果|
|4 |2012 |200 |香蕉|
|5 |2013 |300 |香蕉|
|6 |2014 |400 |香蕉|
|7 |2014 |600 |橘子|</p>

<p>按年度分组求每年销量，及每年销售种类</p>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">ND</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="n">XL</span><span class="p">)</span> <span class="n">SUM_XL</span><span class="p">,</span>
       <span class="k">MAX</span><span class="p">(</span><span class="n">LTRIM</span><span class="p">(</span><span class="n">SYS_CONNECT_BY_PATH</span><span class="p">(</span><span class="n">BZ</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">),</span> <span class="s1">&#39;,&#39;</span><span class="p">))</span> <span class="n">SUM_BZ</span>
  <span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">ND</span><span class="p">,</span> <span class="n">XL</span><span class="p">,</span> <span class="n">BZ</span><span class="p">,</span> <span class="n">ROW_NUMBER</span><span class="p">()</span> <span class="n">OVER</span><span class="p">(</span><span class="n">PARTITION</span> <span class="k">BY</span> <span class="n">ND</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">XL</span><span class="p">)</span> <span class="n">RN</span>
          <span class="k">FROM</span> <span class="n">SMP</span><span class="p">)</span>
 <span class="k">START</span> <span class="k">WITH</span> <span class="n">RN</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">CONNECT</span> <span class="k">BY</span> <span class="k">PRIOR</span> <span class="n">RN</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">=</span> <span class="n">RN</span>
       <span class="k">AND</span> <span class="k">PRIOR</span> <span class="n">ND</span> <span class="o">=</span> <span class="n">ND</span>
 <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">ND</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>累计</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">WITH</span> <span class="n">T</span> <span class="k">AS</span>
 <span class="p">(</span><span class="k">SELECT</span> <span class="mi">1370</span><span class="p">.</span><span class="mi">80</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">1214</span><span class="p">.</span><span class="mi">01</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">284</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">276</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">1</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">922</span><span class="p">.</span><span class="mi">63</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">970</span><span class="p">.</span><span class="mi">01</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">235</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">224</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">2</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">852</span><span class="p">.</span><span class="mi">39</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">864</span><span class="p">.</span><span class="mi">79</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">168</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">168</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">3</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">1007</span><span class="p">.</span><span class="mi">85</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">974</span><span class="p">.</span><span class="mi">16</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">188</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">182</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">4</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">1019</span><span class="p">.</span><span class="mi">80</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">1073</span><span class="p">.</span><span class="mi">05</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">176</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">156</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">5</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">1309</span><span class="p">.</span><span class="mi">98</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">1209</span><span class="p">.</span><span class="mi">75</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">223</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">200</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">7</span> <span class="n">M</span>
    <span class="k">FROM</span> <span class="n">DUAL</span>
  <span class="k">UNION</span> <span class="k">ALL</span>
  <span class="k">SELECT</span> <span class="mi">1308</span><span class="p">.</span><span class="mi">83</span> <span class="n">CL</span><span class="p">,</span> <span class="mi">1567</span><span class="p">.</span><span class="mi">57</span> <span class="n">XL</span><span class="p">,</span> <span class="mi">234</span> <span class="n">MJA</span><span class="p">,</span> <span class="mi">243</span> <span class="n">MJB</span><span class="p">,</span> <span class="mi">8</span> <span class="n">M</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">T</span><span class="p">.</span><span class="n">M</span><span class="p">,</span>
       <span class="n">T</span><span class="p">.</span><span class="n">CL</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">CL</span><span class="p">)</span> <span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">ROWNUM</span> <span class="k">ROWS</span> <span class="k">BETWEEN</span> <span class="n">UNBOUNDED</span> <span class="n">PRECEDING</span> <span class="k">AND</span> <span class="k">CURRENT</span> <span class="k">ROW</span><span class="p">)</span> <span class="n">CLLJ</span><span class="p">,</span>
       <span class="n">T</span><span class="p">.</span><span class="n">XL</span><span class="p">,</span>
       <span class="k">SUM</span><span class="p">(</span><span class="n">T</span><span class="p">.</span><span class="n">XL</span><span class="p">)</span> <span class="n">OVER</span><span class="p">(</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="n">ROWNUM</span> <span class="k">ROWS</span> <span class="k">BETWEEN</span> <span class="n">UNBOUNDED</span> <span class="n">PRECEDING</span> <span class="k">AND</span> <span class="k">CURRENT</span> <span class="k">ROW</span><span class="p">)</span> <span class="n">XLLJ</span><span class="p">,</span>
       <span class="n">T</span><span class="p">.</span><span class="n">MJA</span><span class="p">,</span>
       <span class="n">T</span><span class="p">.</span><span class="n">MJB</span>
  <span class="k">FROM</span> <span class="n">T</span>
</code></pre></div>
<h3>oracle job</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">--创建测试表</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">SMP</span> <span class="p">(</span><span class="n">A</span> <span class="nb">DATE</span><span class="p">);</span>
<span class="c1">--创建测试存储过程</span>
<span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="k">PROCEDURE</span> <span class="n">SMP_PROC</span> <span class="k">AS</span>
<span class="k">BEGIN</span>
    <span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">SMP</span> <span class="k">VALUES</span> <span class="p">(</span><span class="n">SYSDATE</span><span class="p">)</span>
<span class="k">END</span><span class="p">;</span>

<span class="c1">--1.定义数字</span>
<span class="k">DECLARE</span> <span class="n">SMP_NUM</span> <span class="nb">NUMBER</span><span class="p">;</span>

<span class="c1">--2.定义job</span>
<span class="k">BEGIN</span>
    <span class="n">DBMS_JOB</span><span class="p">.</span><span class="n">SUBMIT</span><span class="p">(</span>
        <span class="n">JOB</span><span class="o">=&gt;</span><span class="n">SMP_JOB</span><span class="p">,</span>
        <span class="n">WHAT</span><span class="o">=&gt;</span><span class="s1">&#39;SMP_PROC&#39;</span>
        <span class="n">NEXT_DATE</span><span class="o">=&gt;</span><span class="n">SYSDATE</span>
        <span class="nb">INTERVAL</span><span class="o">=&gt;</span><span class="s1">&#39;TRUNC(SYSDATE + 1) + (7*60+30)/(24*60)&#39;</span><span class="p">,</span><span class="cm">/*每天7点半*/</span>
        <span class="n">NO_PARSE</span><span class="o">=&gt;</span><span class="k">TRUE</span>
    <span class="p">)</span>
<span class="k">END</span><span class="p">;</span>

<span class="c1">--3.查询job</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">USER_JOBS</span><span class="p">;</span>

<span class="c1">--4.删除job</span>
<span class="k">BEGIN</span>
<span class="n">SBMS_JOB</span><span class="p">.</span><span class="n">REMOVE</span><span class="p">(</span><span class="mi">150</span><span class="p">);</span>
<span class="k">END</span><span class="p">;</span>

<span class="c1">--5.修改job</span>
<span class="k">BEGIN</span>
<span class="n">DBMS_JOB</span><span class="p">.</span><span class="n">BROKEN</span><span class="p">(</span><span class="mi">287</span><span class="p">,</span><span class="k">FALSE</span><span class="p">,</span><span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span><span class="s1">&#39;HH&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">24</span><span class="p">);</span>
<span class="k">END</span><span class="p">;</span>

<span class="c1">--6.启动job</span>
<span class="k">BEGIN</span>
<span class="n">DBMS_JOB</span><span class="p">.</span><span class="n">RUN</span><span class="p">(</span><span class="mi">287</span><span class="p">);</span>
<span class="k">END</span><span class="p">;</span>

<span class="cm">/*--------------------------------------------------*/</span>

<span class="cm">/*每个午夜12点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每个早上8点半*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="mi">30</span><span class="err">）</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每个星期二中午12点*/</span>
<span class="k">SELECT</span> <span class="n">NEXT_DAY</span><span class="p">(</span><span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">),</span> <span class="s1">&#39;星期二&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每月第一天的12点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">LAST_DAY</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每个季度最后一天的晚上11点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">ADD_MONTHS</span><span class="p">(</span><span class="n">SYSDATE</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每星期六和日早上6点10分*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">LEAST</span><span class="p">(</span><span class="n">NEXT_DAY</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;星期六&#39;</span><span class="p">),</span> <span class="n">NEXT_DAY</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;星期日&#39;</span><span class="p">)))</span> <span class="o">+</span>
       <span class="err">（</span><span class="mi">6</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="mi">10</span><span class="err">）</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span><span class="p">)</span>
  <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每分钟*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;mi&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span><span class="p">),</span> <span class="n">SYSDATE</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">1440</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每天凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每周一凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">NEXT_DAY</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;星期一&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每月1日凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">LAST_DAY</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每季度第一天凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">TRUNC</span><span class="p">(</span><span class="n">ADD_MONTHS</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每年7月1日凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">ADD_MONTHS</span><span class="p">(</span><span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;yyyy&#39;</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*每年1月1日凌晨1点*/</span>
<span class="k">SELECT</span> <span class="n">ADD_MONTHS</span><span class="p">(</span><span class="n">TRUNC</span><span class="p">(</span><span class="n">SYSDATE</span><span class="p">,</span> <span class="s1">&#39;yyyy&#39;</span><span class="p">),</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">24</span> <span class="k">FROM</span> <span class="n">DUAL</span><span class="p">;</span>

<span class="cm">/*--------------------------------------------------*/</span>
</code></pre></div>
<h3>oracle 记录被锁住</h3>

<ul>
<li>单节点</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">OBJECT_ID</span><span class="p">,</span> <span class="n">SESSION_ID</span><span class="p">,</span> <span class="n">LOCKED_MODE</span> <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="n">LOCKED_OBJECT</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="n">T2</span><span class="p">.</span><span class="n">USERNAME</span><span class="p">,</span> <span class="n">T2</span><span class="p">.</span><span class="n">SID</span><span class="p">,</span> <span class="n">T2</span><span class="p">.</span><span class="nb">SERIAL</span><span class="o">#</span><span class="p">,</span> <span class="n">T2</span><span class="p">.</span><span class="n">LOGON_TIME</span>
  <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="n">LOCKED_OBJECT</span> <span class="n">T1</span><span class="p">,</span> <span class="n">V</span><span class="err">$</span><span class="k">SESSION</span> <span class="n">T2</span>
 <span class="k">WHERE</span> <span class="n">T1</span><span class="p">.</span><span class="n">SESSION_ID</span> <span class="o">=</span> <span class="n">T2</span><span class="p">.</span><span class="n">SID</span><span class="p">;</span>

<span class="k">ALTER</span> <span class="k">SYSTEM</span> <span class="n">KILL</span> <span class="k">SESSION</span> <span class="s1">&#39;290,5393&#39;</span><span class="p">;</span> <span class="cm">/* SID,SERIAL# */</span>

<span class="c1">--查询导致被锁的SQL语句</span>
<span class="k">SELECT</span> <span class="n">SQL_TEXT</span>
  <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="k">SQL</span>
 <span class="k">WHERE</span> <span class="n">HASH_VALUE</span> <span class="k">IN</span>
       <span class="p">(</span><span class="k">SELECT</span> <span class="n">SQL_HASH_VALUE</span>
          <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="k">SESSION</span>
         <span class="k">WHERE</span> <span class="n">SID</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">SESSION_ID</span> <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="n">LOCKED_OBJECT</span><span class="p">))</span>

<span class="c1">--批量杀session</span>
<span class="k">SELECT</span> <span class="n">SID</span><span class="p">,</span>
       <span class="nb">SERIAL</span><span class="o">#</span><span class="p">,</span>
       <span class="n">USERNAME</span><span class="p">,</span>
       <span class="s1">&#39;alter system kill session &#39;&#39;&#39;</span> <span class="o">||</span> <span class="n">SID</span> <span class="o">||</span> <span class="s1">&#39;,&#39;</span> <span class="o">||</span> <span class="nb">SERIAL</span><span class="o">#</span> <span class="o">||</span> <span class="s1">&#39;&#39;&#39;;&#39;</span>
  <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="k">SESSION</span>
 <span class="k">WHERE</span> <span class="n">STATUS</span> <span class="o">=</span> <span class="s1">&#39;INACTIVE&#39;</span>
   <span class="k">AND</span> <span class="n">USERNAME</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETY&#39;</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>集群</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="cm">/*查session（如果数据库集群gv$session）*/</span>
<span class="k">select</span> <span class="n">username</span><span class="p">,</span><span class="n">sid</span><span class="p">,</span><span class="nb">serial</span><span class="o">#</span> <span class="k">from</span> <span class="n">gv</span><span class="err">$</span><span class="k">session</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="k">LIKE</span> <span class="s1">&#39;GDSAFETY&#39;</span><span class="cm">/*用户*/</span>

<span class="cm">/*杀session*/</span>
<span class="k">alter</span> <span class="k">system</span> <span class="n">kill</span> <span class="k">session</span><span class="s1">&#39;153,20765&#39;</span> 
<span class="cm">/*gv$是全局视图，而v$是针对某个实例的视图，$X是所有gv$的数据来源，从gv$到v$需要加上where inst_id = USERENV(’Instance’)*/</span>
<span class="k">SELECT</span> <span class="n">S</span><span class="p">.</span><span class="n">INST_ID</span><span class="p">,</span>
       <span class="n">S</span><span class="p">.</span><span class="n">SID</span><span class="p">,</span>
       <span class="n">S</span><span class="p">.</span><span class="nb">SERIAL</span><span class="o">#</span><span class="p">,</span>
       <span class="n">P</span><span class="p">.</span><span class="n">SPID</span><span class="p">,</span> <span class="cm">/*线程号*/</span>
       <span class="n">S</span><span class="p">.</span><span class="n">USERNAME</span><span class="p">,</span>
       <span class="n">S</span><span class="p">.</span><span class="n">PROGRAM</span><span class="p">,</span>
       <span class="n">P</span><span class="p">.</span><span class="n">PID</span>
  <span class="k">FROM</span> <span class="n">GV</span><span class="err">$</span><span class="k">SESSION</span> <span class="n">S</span>
  <span class="k">JOIN</span> <span class="n">GV</span><span class="err">$</span><span class="n">PROCESS</span> <span class="n">P</span>
    <span class="k">ON</span> <span class="n">P</span><span class="p">.</span><span class="n">ADDR</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">PADDR</span>
   <span class="k">AND</span> <span class="n">P</span><span class="p">.</span><span class="n">INST_ID</span> <span class="o">=</span> <span class="n">S</span><span class="p">.</span><span class="n">INST_ID</span>
 <span class="k">WHERE</span> <span class="n">S</span><span class="p">.</span><span class="k">TYPE</span> <span class="o">!=</span> <span class="s1">&#39;BACKGROUND&#39;</span>
   <span class="k">AND</span> <span class="n">S</span><span class="p">.</span><span class="n">USERNAME</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETY&#39;</span>
</code></pre></div>
<ul>
<li>锁住时间过长而杀不死的</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="cm">/*OS级杀线程linux*/</span>
<span class="n">kill</span> <span class="o">-</span><span class="mi">9</span> <span class="mi">12345</span> <span class="cm">/*spid*/</span>
<span class="cm">/*OS级杀线程windows*/</span>
<span class="n">orakill</span> <span class="n">orcl</span><span class="cm">/*实例名*/</span> <span class="mi">12345</span><span class="cm">/*spid*/</span>
</code></pre></div>
<h3>删除用户</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">alter</span> <span class="k">user</span> <span class="n">XXX</span> <span class="n">account</span> <span class="k">lock</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="k">SESSION</span> <span class="k">WHERE</span> <span class="n">USERNAME</span><span class="o">=</span><span class="s1">&#39;XXX&#39;</span><span class="p">;</span>
<span class="k">alter</span> <span class="k">system</span> <span class="n">kill</span> <span class="k">session</span> <span class="s1">&#39;147,3749&#39;</span><span class="p">;</span>
<span class="k">drop</span> <span class="k">user</span> <span class="n">XXX</span> <span class="k">CASCADE</span><span class="p">;</span>
</code></pre></div>
<h3>修改用户密码</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="n">sqlplus</span> <span class="o">/</span> <span class="k">as</span> <span class="n">sysdba</span> <span class="p">;</span>
<span class="k">alter</span> <span class="k">user</span> <span class="k">system</span><span class="cm">/*用户*/</span> <span class="n">identified</span> <span class="k">by</span> <span class="n">abc</span><span class="cm">/*新密码*/</span><span class="p">;</span> 
</code></pre></div>
<h3>有趣的面试题</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">-- 小小+霸霸+王王=小霸王</span>
<span class="c1">--小=? 霸=? 王=?</span>
<span class="c1">--1,9,8</span>
<span class="c1">--xx+yy+zz=xyz</span>
<span class="c1">--x=?,y=?,z=?</span>

<span class="c1">--我的答案</span>
<span class="k">WITH</span> <span class="n">T</span> <span class="k">AS</span>
 <span class="p">(</span><span class="k">SELECT</span> <span class="n">ROWNUM</span> <span class="o">-</span> <span class="mi">1</span> <span class="n">RN</span> <span class="k">FROM</span> <span class="n">DUAL</span> <span class="k">CONNECT</span> <span class="k">BY</span> <span class="n">ROWNUM</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">T1</span><span class="p">.</span><span class="n">RN</span> <span class="n">A</span><span class="p">,</span> <span class="n">T2</span><span class="p">.</span><span class="n">RN</span> <span class="n">B</span><span class="p">,</span> <span class="n">T3</span><span class="p">.</span><span class="n">RN</span> <span class="k">C</span>
  <span class="k">FROM</span> <span class="n">T</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T</span> <span class="n">T2</span><span class="p">,</span> <span class="n">T</span> <span class="n">T3</span>
 <span class="k">WHERE</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">T1</span><span class="p">.</span><span class="n">RN</span> <span class="o">||</span> <span class="n">T1</span><span class="p">.</span><span class="n">RN</span><span class="p">)</span> <span class="o">+</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">T2</span><span class="p">.</span><span class="n">RN</span> <span class="o">||</span> <span class="n">T2</span><span class="p">.</span><span class="n">RN</span><span class="p">)</span> <span class="o">+</span>
       <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">T3</span><span class="p">.</span><span class="n">RN</span> <span class="o">||</span> <span class="n">T3</span><span class="p">.</span><span class="n">RN</span><span class="p">)</span> <span class="o">=</span> <span class="n">TO_NUMBER</span><span class="p">(</span><span class="n">T1</span><span class="p">.</span><span class="n">RN</span> <span class="o">||</span> <span class="n">T2</span><span class="p">.</span><span class="n">RN</span> <span class="o">||</span> <span class="n">T3</span><span class="p">.</span><span class="n">RN</span><span class="p">);</span>

<span class="c1">--官方的</span>
<span class="k">WITH</span> <span class="n">N_LIST</span> <span class="k">AS</span>
 <span class="p">(</span><span class="k">SELECT</span> <span class="n">ROWNUM</span> <span class="n">N</span> <span class="k">FROM</span> <span class="n">DUAL</span> <span class="k">CONNECT</span> <span class="k">BY</span> <span class="n">ROWNUM</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">)</span>
<span class="k">SELECT</span> <span class="n">N</span>
  <span class="k">FROM</span> <span class="n">N_LIST</span>
 <span class="k">WHERE</span> <span class="p">(</span><span class="n">SUBSTR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">SUBSTR</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">11</span> <span class="o">=</span> <span class="n">N</span>
   <span class="k">AND</span> <span class="n">N</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">;</span>
</code></pre></div>
<h3>sql 执行时间长</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="k">session</span> <span class="k">WHERE</span> <span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;XXX&#39;</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="k">sql</span> <span class="k">WHERE</span> <span class="n">sql_id</span> <span class="o">=</span> <span class="s1">&#39;crkxpjsfju45z&#39;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="n">transaction</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">VALUE</span> <span class="k">FROM</span> <span class="n">gv</span><span class="err">$</span><span class="k">parameter</span> <span class="k">WHERE</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s1">&#39;resource_limit&#39;</span><span class="p">;</span>


<span class="c1">--查看resource limit是否开启</span>
 <span class="k">SELECT</span> <span class="n">NAME</span><span class="p">,</span> <span class="n">VALUE</span> <span class="k">FROM</span> <span class="n">gv</span><span class="err">$</span><span class="k">parameter</span> <span class="k">WHERE</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s1">&#39;resource_limit&#39;</span><span class="p">;</span>
 <span class="c1">--开启resource limit</span>
 <span class="k">ALTER</span> <span class="k">system</span> <span class="k">SET</span> <span class="n">resource_limit</span> <span class="o">=</span> <span class="k">TRUE</span><span class="p">;</span>

<span class="c1">--查询资源文件，找到CONNECT_TIME所在的profile名。</span>
 <span class="k">SELECT</span> <span class="n">resource_name</span><span class="p">,</span> <span class="n">profile</span> <span class="k">FROM</span> <span class="n">dba_profiles</span><span class="p">;</span>
 <span class="c1">--用alter命令修改profile中的值；--（或跟一个时间值，如1000，单位为分钟）</span>
 <span class="k">ALTER</span> <span class="n">profile</span> <span class="n">monitoring_profile</span> <span class="k">LIMIT</span> <span class="n">connect_time</span> <span class="n">unlimited</span><span class="p">;</span>
 <span class="k">ALTER</span> <span class="n">profile</span> <span class="n">monitoring_profile</span> <span class="k">LIMIT</span> <span class="n">idle_time</span> <span class="n">unlimited</span><span class="p">;</span>

<span class="c1">--用如下命令查看profile中的值；</span>
 <span class="k">SELECT</span> <span class="n">resource_name</span><span class="p">,</span> <span class="k">LIMIT</span>
   <span class="k">FROM</span> <span class="n">dba_profiles</span>
 <span class="k">WHERE</span> <span class="n">profile</span> <span class="o">=</span> <span class="s1">&#39;MONITORING_PROFILE&#39;</span><span class="p">;</span>
</code></pre></div>
<h3>oracle 查看状态</h3>

<ul>
<li>查看表空间使用情况</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="k">UPPER</span><span class="p">(</span><span class="n">F</span><span class="p">.</span><span class="n">TABLESPACE_NAME</span><span class="p">)</span> <span class="ss">&quot;表空间名&quot;</span><span class="p">,</span>
<span class="err">　　</span><span class="n">D</span><span class="p">.</span><span class="n">TOT_GROOTTE_MB</span> <span class="ss">&quot;表空间大小(M)&quot;</span><span class="p">,</span>
<span class="err">　　</span><span class="n">D</span><span class="p">.</span><span class="n">TOT_GROOTTE_MB</span> <span class="o">-</span> <span class="n">F</span><span class="p">.</span><span class="n">TOTAL_BYTES</span> <span class="ss">&quot;已使用空间(M)&quot;</span><span class="p">,</span>
<span class="err">　　</span><span class="n">TO_CHAR</span><span class="p">(</span><span class="n">ROUND</span><span class="p">((</span><span class="n">D</span><span class="p">.</span><span class="n">TOT_GROOTTE_MB</span> <span class="o">-</span> <span class="n">F</span><span class="p">.</span><span class="n">TOTAL_BYTES</span><span class="p">)</span> <span class="o">/</span> <span class="n">D</span><span class="p">.</span><span class="n">TOT_GROOTTE_MB</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="s1">&#39;990.99&#39;</span><span class="p">)</span> <span class="o">||</span> <span class="s1">&#39;%&#39;</span> <span class="ss">&quot;使用比&quot;</span><span class="p">,</span>
<span class="err">　　</span><span class="n">F</span><span class="p">.</span><span class="n">TOTAL_BYTES</span> <span class="ss">&quot;空闲空间(M)&quot;</span><span class="p">,</span>
<span class="err">　　</span><span class="n">F</span><span class="p">.</span><span class="n">MAX_BYTES</span> <span class="ss">&quot;最大块(M)&quot;</span>
<span class="err">　　</span><span class="k">FROM</span> <span class="p">(</span><span class="k">SELECT</span> <span class="n">TABLESPACE_NAME</span><span class="p">,</span>
<span class="err">　　</span><span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">BYTES</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="n">TOTAL_BYTES</span><span class="p">,</span>
<span class="err">　　</span><span class="n">ROUND</span><span class="p">(</span><span class="k">MAX</span><span class="p">(</span><span class="n">BYTES</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="n">MAX_BYTES</span>
<span class="err">　　</span><span class="k">FROM</span> <span class="n">SYS</span><span class="p">.</span><span class="n">DBA_FREE_SPACE</span>
<span class="err">　　</span><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">TABLESPACE_NAME</span><span class="p">)</span> <span class="n">F</span><span class="p">,</span>
<span class="err">　　</span><span class="p">(</span><span class="k">SELECT</span> <span class="n">DD</span><span class="p">.</span><span class="n">TABLESPACE_NAME</span><span class="p">,</span>
<span class="err">　　</span> <span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">DD</span><span class="p">.</span><span class="n">BYTES</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="n">TOT_GROOTTE_MB</span>
<span class="err">　　</span><span class="k">FROM</span> <span class="n">SYS</span><span class="p">.</span><span class="n">DBA_DATA_FILES</span> <span class="n">DD</span>
<span class="err">　　</span><span class="k">GROUP</span> <span class="k">BY</span> <span class="n">DD</span><span class="p">.</span><span class="n">TABLESPACE_NAME</span><span class="p">)</span> <span class="n">D</span>
<span class="err">　　</span><span class="k">WHERE</span> <span class="n">D</span><span class="p">.</span><span class="n">TABLESPACE_NAME</span> <span class="o">=</span> <span class="n">F</span><span class="p">.</span><span class="n">TABLESPACE_NAME</span>
<span class="err">　　</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>查看表空间可用容量</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="n">tablespace_name</span><span class="p">,</span>
<span class="err">　　</span><span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">extends</span><span class="p">,</span>
<span class="err">　　</span><span class="n">round</span><span class="p">(</span><span class="k">sum</span><span class="p">(</span><span class="n">bytes</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">MB</span><span class="p">,</span>
<span class="err">　　</span><span class="k">sum</span><span class="p">(</span><span class="n">blocks</span><span class="p">)</span> <span class="k">as</span> <span class="n">blocks</span>
<span class="err">　　</span><span class="k">from</span> <span class="n">dba_free_space</span>
<span class="err">　　</span><span class="k">group</span> <span class="k">by</span> <span class="n">tablespace_name</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>查看正在执行的SQL和执行该SQL的用户</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">--查询Oracle正在执行的sql语句及执行该语句的用户</span>
<span class="k">SELECT</span> <span class="n">b</span><span class="p">.</span><span class="n">sid</span> <span class="n">oracleID</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">username</span> <span class="err">登录</span><span class="n">Oracle</span><span class="err">用户名</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="nb">serial</span><span class="o">#</span><span class="p">,</span>
       <span class="n">spid</span> <span class="err">操作系统</span><span class="n">ID</span><span class="p">,</span>
       <span class="n">paddr</span><span class="p">,</span>
       <span class="n">sql_text</span> <span class="err">正在执行的</span><span class="k">SQL</span><span class="p">,</span>
       <span class="n">b</span><span class="p">.</span><span class="n">machine</span> <span class="err">计算机名</span>
<span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="n">process</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="err">$</span><span class="k">session</span> <span class="n">b</span><span class="p">,</span> <span class="n">v</span><span class="err">$</span><span class="n">sqlarea</span> <span class="k">c</span>
<span class="k">WHERE</span> <span class="n">a</span><span class="p">.</span><span class="n">addr</span> <span class="o">=</span> <span class="n">b</span><span class="p">.</span><span class="n">paddr</span>
   <span class="k">AND</span> <span class="n">b</span><span class="p">.</span><span class="n">sql_hash_value</span> <span class="o">=</span> <span class="k">c</span><span class="p">.</span><span class="n">hash_value</span>
   <span class="k">AND</span> <span class="n">b</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETY&#39;</span>

<span class="c1">--查看正在执行sql的发起者和发起程序</span>
<span class="k">SELECT</span> <span class="n">OSUSER</span> <span class="err">电脑登录身份</span><span class="p">,</span>
       <span class="n">PROGRAM</span> <span class="err">发起请求的程序</span><span class="p">,</span>
       <span class="n">USERNAME</span> <span class="err">登录系统的用户名</span><span class="p">,</span>
       <span class="n">SCHEMANAME</span><span class="p">,</span>
       <span class="n">B</span><span class="p">.</span><span class="n">Cpu_Time</span> <span class="err">花费</span><span class="n">cpu</span><span class="err">的时间</span><span class="p">,</span>
       <span class="n">STATUS</span><span class="p">,</span>
       <span class="n">B</span><span class="p">.</span><span class="n">SQL_TEXT</span> <span class="err">执行的</span><span class="k">sql</span>
<span class="k">FROM</span> <span class="n">V</span><span class="err">$</span><span class="k">SESSION</span> <span class="n">A</span>
<span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">V</span><span class="err">$</span><span class="k">SQL</span> <span class="n">B</span> <span class="k">ON</span> <span class="n">A</span><span class="p">.</span><span class="n">SQL_ADDRESS</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">ADDRESS</span>
                   <span class="k">AND</span> <span class="n">A</span><span class="p">.</span><span class="n">SQL_HASH_VALUE</span> <span class="o">=</span> <span class="n">B</span><span class="p">.</span><span class="n">HASH_VALUE</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">b</span><span class="p">.</span><span class="n">cpu_time</span> <span class="k">DESC</span>

<span class="c1">--查出oracle当前的被锁对象</span>
<span class="k">SELECT</span> <span class="n">l</span><span class="p">.</span><span class="n">session_id</span> <span class="n">sid</span><span class="p">,</span>
       <span class="n">s</span><span class="p">.</span><span class="nb">serial</span><span class="o">#</span><span class="p">,</span>
       <span class="n">l</span><span class="p">.</span><span class="n">locked_mode</span> <span class="err">锁模式</span><span class="p">,</span>
       <span class="n">l</span><span class="p">.</span><span class="n">oracle_username</span> <span class="err">登录用户</span><span class="p">,</span>
       <span class="n">l</span><span class="p">.</span><span class="n">os_user_name</span> <span class="err">登录机器用户名</span><span class="p">,</span>
       <span class="n">s</span><span class="p">.</span><span class="n">machine</span> <span class="err">机器名</span><span class="p">,</span>
       <span class="n">s</span><span class="p">.</span><span class="n">terminal</span> <span class="err">终端用户名</span><span class="p">,</span>
       <span class="n">o</span><span class="p">.</span><span class="n">object_name</span> <span class="err">被锁对象名</span><span class="p">,</span>
       <span class="n">s</span><span class="p">.</span><span class="n">logon_time</span> <span class="err">登录数据库时间</span>
<span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="n">locked_object</span> <span class="n">l</span><span class="p">,</span> <span class="n">all_objects</span> <span class="n">o</span><span class="p">,</span> <span class="n">v</span><span class="err">$</span><span class="k">session</span> <span class="n">s</span>
<span class="k">WHERE</span> <span class="n">l</span><span class="p">.</span><span class="n">object_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">object_id</span>
   <span class="k">AND</span> <span class="n">l</span><span class="p">.</span><span class="n">session_id</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">sid</span>
<span class="k">ORDER</span> <span class="k">BY</span> <span class="n">sid</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="nb">serial</span><span class="o">#</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>查看表结构</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">T</span><span class="p">.</span><span class="n">OBJECT_NAME</span><span class="p">,</span>
       <span class="k">C</span><span class="p">.</span><span class="k">COLUMN_NAME</span><span class="p">,</span>
       <span class="k">C</span><span class="p">.</span><span class="n">DATA_TYPE</span><span class="p">,</span>
       <span class="k">C</span><span class="p">.</span><span class="n">DATA_LENGTH</span><span class="p">,</span>
       <span class="k">C</span><span class="p">.</span><span class="n">DATA_PRECISION</span><span class="p">,</span>
       <span class="k">C</span><span class="p">.</span><span class="n">DATA_SCALE</span>
  <span class="k">FROM</span> <span class="n">USER_OBJECTS</span> <span class="n">T</span><span class="p">,</span> <span class="n">USER_TAB_COLUMNS</span> <span class="k">C</span>
 <span class="k">WHERE</span> <span class="n">T</span><span class="p">.</span><span class="n">OBJECT_TYPE</span> <span class="o">=</span> <span class="s1">&#39;TABLE&#39;</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="k">TABLE_NAME</span> <span class="o">=</span> <span class="n">T</span><span class="p">.</span><span class="n">OBJECT_NAME</span>
 <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">OBJECT_NAME</span><span class="p">,</span> <span class="k">COLUMN_NAME</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>查看表大小</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">Select</span> <span class="n">Segment_Name</span><span class="p">,</span><span class="k">Sum</span><span class="p">(</span><span class="n">bytes</span><span class="p">)</span><span class="o">/</span><span class="mi">1024</span><span class="o">/</span><span class="mi">1024</span> <span class="n">sz</span> <span class="k">From</span> <span class="n">User_Extents</span> <span class="k">Group</span> <span class="k">By</span> <span class="n">Segment_Name</span> <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">sz</span> <span class="k">DESC</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>查询插入记录的时间</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">t</span><span class="p">.</span><span class="o">*</span><span class="p">,</span><span class="n">ORA_ROWSCN</span> <span class="k">FROM</span> <span class="n">sms_log</span> <span class="n">t</span><span class="p">;</span>

<span class="k">select</span> <span class="n">to_char</span><span class="p">(</span><span class="n">scn_to_timestamp</span><span class="p">(</span><span class="mi">10896271687717</span><span class="p">),</span><span class="s1">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span class="p">)</span> <span class="n">insert_time</span> <span class="k">from</span> <span class="n">dual</span><span class="p">;</span>
</code></pre></div>
<h3>oracle 错误解决办法</h3>

<ul>
<li>ORA-01658 : 无法为表空间space中的段创建 INITIAL 区；</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="n">SEGMENT_TYPE</span><span class="p">,</span> <span class="k">OWNER</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">BYTES</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span>
  <span class="k">FROM</span> <span class="n">DBA_SEGMENTS</span> <span class="n">T</span>
 <span class="k">WHERE</span> <span class="n">TABLESPACE_NAME</span> <span class="o">=</span> <span class="s1">&#39;USERS&#39;</span>
 <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">SEGMENT_TYPE</span><span class="p">,</span> <span class="k">OWNER</span><span class="p">;</span>

<span class="k">SELECT</span> <span class="o">*</span>
  <span class="k">FROM</span> <span class="n">DBA_TABLESPACES</span> <span class="c1">--查看表空间</span>
       <span class="c1">--查看表空间文件路径</span>
         <span class="k">SELECT</span> <span class="n">TABLESPACE_NAME</span><span class="p">,</span>
                <span class="n">FILE_ID</span><span class="p">,</span>
                <span class="n">BYTES</span> <span class="o">/</span> <span class="mi">1024</span> <span class="o">/</span> <span class="mi">1024</span><span class="p">,</span>
                <span class="n">FILE_NAME</span> <span class="err">　　</span>
           <span class="k">FROM</span> <span class="n">DBA_DATA_FILES</span>
          <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">FILE_ID</span><span class="p">;</span>


<span class="c1">--查看用户和默认表空间的关系</span>
<span class="k">SELECT</span> <span class="n">USERNAME</span><span class="p">,</span> <span class="n">DEFAULT_TABLESPACE</span> <span class="k">FROM</span> <span class="n">DBA_USERS</span><span class="p">;</span>

<span class="c1">--alter tablespace USERS add datafile &#39;D:\SOFTWARE\ORACLE\PRODUCT\10.2.0\ORADATA\ORCL\USERS01.DBF&#39; size 10m; </span>
<span class="k">ALTER</span> <span class="n">TABLESPACE</span> <span class="n">USERS</span> <span class="k">ADD</span> <span class="n">DATAFILE</span> <span class="s1">&#39;D:\SOFTWARE\ORACLE\PRODUCT\10.2.0\ORADATA\ORCL\USERS01.DBF&#39;</span> <span class="k">SIZE</span> <span class="mi">1024</span><span class="n">M</span> <span class="n">AUTOEXTEND</span> <span class="k">ON</span> <span class="k">NEXT</span> <span class="mi">50</span><span class="n">M</span> <span class="n">MAXSIZE</span> <span class="n">UNLIMITED</span><span class="p">;</span>
</code></pre></div>
<h3>oracle 创建表空间</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="cm">/*分为四步 */</span>
<span class="cm">/*第1步：创建临时表空间  */</span>
<span class="k">create</span> <span class="k">temporary</span> <span class="n">tablespace</span> <span class="n">user_temp</span>  
<span class="n">tempfile</span> <span class="s1">&#39;D:\oracle\oradata\Oracle9i\user_temp.dbf&#39;</span> 
<span class="k">size</span> <span class="mi">50</span><span class="n">m</span>  
<span class="n">autoextend</span> <span class="k">on</span>  
<span class="k">next</span> <span class="mi">50</span><span class="n">m</span> <span class="n">maxsize</span> <span class="mi">20480</span><span class="n">m</span>  
<span class="n">extent</span> <span class="n">management</span> <span class="k">local</span><span class="p">;</span>  

<span class="cm">/*第2步：创建数据表空间  */</span>
<span class="k">create</span> <span class="n">tablespace</span> <span class="n">gdsafety</span>  
<span class="n">logging</span>  
<span class="n">datafile</span> <span class="s1">&#39;D:\software\oracle\product\10.2.0\oradata\tablespaces\gdsafety.dbf&#39;</span> 
<span class="k">size</span> <span class="mi">50</span><span class="n">m</span>  
<span class="n">autoextend</span> <span class="k">on</span>  
<span class="k">next</span> <span class="mi">50</span><span class="n">m</span> <span class="n">maxsize</span> <span class="mi">20480</span><span class="n">m</span>  
<span class="n">extent</span> <span class="n">management</span> <span class="k">local</span><span class="p">;</span>  

<span class="cm">/*第3步：创建用户并指定表空间  */</span>
<span class="k">create</span> <span class="k">user</span> <span class="n">username</span> <span class="n">identified</span> <span class="k">by</span> <span class="n">password</span>  
<span class="k">default</span> <span class="n">tablespace</span> <span class="n">user_data</span>  
<span class="k">temporary</span> <span class="n">tablespace</span> <span class="n">user_temp</span><span class="p">;</span>  

<span class="cm">/*第4步：给用户授予权限  */</span>
<span class="k">grant</span> <span class="k">connect</span><span class="p">,</span><span class="n">resource</span><span class="p">,</span><span class="n">dba</span> <span class="k">to</span> <span class="n">username</span><span class="p">;</span>
<span class="cm">/*修改默认表空间*/</span>
<span class="k">ALTER</span> <span class="k">USER</span> <span class="n">gdsafety</span> <span class="k">default</span> <span class="n">tablespace</span> <span class="n">gdsafety</span> <span class="p">;</span>  
</code></pre></div>
<h3>oracle 数据恢复</h3>

<ul>
<li>闪回</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">d_pub_reports</span> <span class="k">as</span> <span class="k">of</span> <span class="k">timestamp</span> <span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2014-01-15 22:50:00&#39;</span><span class="p">,</span><span class="s1">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span class="p">);</span> 
<span class="c1">--恢复到某个时间点</span>
<span class="n">flashback</span> <span class="k">table</span> <span class="n">d_pub_reports</span> <span class="k">to</span> <span class="k">timestamp</span> <span class="n">to_timestamp</span><span class="p">(</span><span class="s1">&#39;2014-01-15 22:50:00&#39;</span><span class="p">,</span><span class="s1">&#39;yyyy-mm-dd hh24:mi:ss&#39;</span><span class="p">);</span>
<span class="c1">--恢复到删除前</span>
<span class="n">flashback</span> <span class="k">table</span> <span class="n">t_item_system</span> <span class="k">to</span> <span class="k">before</span> <span class="k">drop</span><span class="p">;</span>
</code></pre></div>
<ul>
<li>恢复视图</li>
</ul>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="k">SELECT</span> <span class="o">*</span>
  <span class="k">FROM</span> <span class="n">ALL_SOURCE</span> <span class="k">AS</span> <span class="k">OF</span> <span class="k">TIMESTAMP</span><span class="p">(</span><span class="n">SYSTIMESTAMP</span> <span class="o">-</span> <span class="nb">INTERVAL</span> <span class="s1">&#39;6000&#39;</span> <span class="k">SECOND</span><span class="p">)</span>
 <span class="k">WHERE</span> <span class="k">TYPE</span> <span class="o">=</span> <span class="s1">&#39;PROCEDURE&#39;</span>
   <span class="k">AND</span> <span class="k">OWNER</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETY&#39;</span>
   <span class="k">AND</span> <span class="n">NAME</span> <span class="o">=</span> <span class="s1">&#39;PRO_PRODUCTION_SBDJHSJ_M&#39;</span>
 <span class="k">ORDER</span> <span class="k">BY</span> <span class="n">LINE</span>
</code></pre></div>
<h3>oracle 禁用启用外键</h3>

<p>删除表数据时，外键约束，先禁用外键约束，删除后启用约束</p>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="cm">/*查询语句*/</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">d_pub_org</span><span class="p">;</span>
<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">d_pub_org</span><span class="o">@</span><span class="n">DB237</span><span class="p">;</span>

<span class="cm">/*查询表的主键*/</span>
<span class="k">SELECT</span> <span class="o">*</span>
  <span class="k">FROM</span> <span class="n">DBA_CONSTRAINTS</span> <span class="k">C</span>
 <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="k">OWNER</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETY&#39;</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="k">TABLE_NAME</span> <span class="o">=</span> <span class="s1">&#39;D_PUB_ORG&#39;</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="n">CONSTRAINT_TYPE</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">;</span>
<span class="k">AND</span> <span class="k">c</span><span class="p">.</span><span class="k">constraint_name</span> <span class="k">LIKE</span> <span class="s1">&#39;FK_T_ORG_%&#39;</span>
<span class="cm">/*根据表的主键找外键*/</span>
<span class="k">SELECT</span> <span class="o">*</span>
  <span class="k">FROM</span> <span class="n">DBA_CONSTRAINTS</span> <span class="k">C</span>
 <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="n">R_CONSTRAINT_NAME</span> <span class="o">=</span> <span class="s1">&#39;PK_D_PUB_ORG&#39;</span>
<span class="cm">/*禁用外键*/</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">T_ORG_BASISMESSAGE</span><span class="cm">/*表名*/</span> <span class="n">disable</span> <span class="k">constraint</span> <span class="n">FK_T_ORG_BA_REFERENCE_D_PUB_OR</span><span class="cm">/*约束名*/</span><span class="p">;</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">T_SAFETY_ATTACH_OTHER</span><span class="cm">/*表名*/</span> <span class="n">disable</span> <span class="k">constraint</span> <span class="n">FK_T_SAFETY_REFERENCE_D_PUB_OR</span><span class="cm">/*约束名*/</span><span class="p">;</span>
<span class="cm">/*删除数据*/</span>
<span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">d_pub_org</span><span class="p">;</span>
<span class="cm">/*导入数据*/</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">d_pub_org</span> <span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">d_pub_org</span><span class="o">@</span><span class="n">DB237</span><span class="p">;</span>
<span class="cm">/*启用约束*/</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">T_ORG_BASISMESSAGE</span><span class="cm">/*表名*/</span> <span class="n">ENABLE</span> <span class="k">constraint</span> <span class="n">FK_T_ORG_BA_REFERENCE_D_PUB_OR</span><span class="cm">/*约束名*/</span> <span class="p">;</span>
<span class="k">alter</span> <span class="k">table</span> <span class="n">T_SAFETY_ATTACH_OTHER</span><span class="cm">/*表名*/</span> <span class="n">ENABLE</span> <span class="k">constraint</span> <span class="n">FK_T_SAFETY_REFERENCE_D_PUB_OR</span><span class="cm">/*约束名*/</span><span class="p">;</span>

<span class="cm">/*根据表名找子表*/</span>
<span class="k">SELECT</span> <span class="k">TABLE_NAME</span>
  <span class="k">FROM</span> <span class="n">DBA_CONSTRAINTS</span> <span class="k">C</span>
 <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="n">R_CONSTRAINT_NAME</span> <span class="o">=</span>
       <span class="p">(</span><span class="k">SELECT</span> <span class="k">CONSTRAINT_NAME</span>
          <span class="k">FROM</span> <span class="n">DBA_CONSTRAINTS</span> <span class="k">C</span>
         <span class="k">WHERE</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">1</span>
           <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="k">TABLE_NAME</span> <span class="o">=</span> <span class="s1">&#39;T_SCIENCE_PLAN_GATHER&#39;</span>
           <span class="k">AND</span> <span class="k">C</span><span class="p">.</span><span class="n">CONSTRAINT_TYPE</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span><span class="p">)</span>
</code></pre></div>
<h3>oracle 同步表和视图</h3>
<div class="highlight"><pre><code class="language-sql" data-lang="sql"><span class="c1">--1.普通表</span>
<span class="k">drop</span> <span class="k">table</span> <span class="n">T_YX_FWGDL_CHECK</span><span class="p">;</span> <span class="cm">/*扔掉表*/</span>
<span class="k">create</span> <span class="k">table</span> <span class="n">T_PRO_UNIT_STATUSBB</span> <span class="k">as</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">T_PRO_UNIT_STATUSBB</span><span class="o">@</span><span class="n">Gdsafetyah_237</span><span class="p">;</span><span class="cm">/*同步表*/</span>
<span class="c1">--2.视图</span>
<span class="k">select</span> <span class="s1">&#39;create view &#39;</span> <span class="o">||</span> <span class="n">view_name</span> <span class="o">||</span> <span class="s1">&#39; as&#39;</span><span class="p">,</span> <span class="nb">text</span>
  <span class="k">from</span> <span class="n">dba_views</span><span class="o">@</span><span class="n">gdsafetyah_237</span>
 <span class="k">where</span> <span class="n">view_name</span> <span class="o">=</span> <span class="s1">&#39;V_PUB_CAPACITY_VALUE&#39;</span>
   <span class="k">and</span> <span class="k">owner</span> <span class="o">=</span> <span class="s1">&#39;GDSAFETYAH&#39;</span><span class="p">;</span>
<span class="c1">--3.带long类型的表的同步</span>

<span class="k">Declare</span>
<span class="k">CURSOR</span> <span class="n">bcur</span>
 <span class="k">IS</span> <span class="k">select</span> <span class="n">TIME_ID</span><span class="p">,</span><span class="n">BYCONTEN1</span> <span class="k">from</span> <span class="n">T_PRO_UNIT_STATUSBB</span><span class="o">@</span><span class="n">Gdsafetyah_237</span><span class="p">;</span>
  <span class="n">brec</span> <span class="n">bcur</span><span class="o">%</span><span class="n">ROWTYPE</span><span class="p">;</span>
 <span class="k">BEGIN</span>
 <span class="k">insert</span> <span class="k">into</span> <span class="n">T_PRO_UNIT_STATUSBB</span><span class="p">(</span><span class="n">TIME_ID</span><span class="p">,</span><span class="n">content</span><span class="p">,</span><span class="n">Byconten</span><span class="p">)</span> <span class="k">select</span> <span class="n">TIME_ID</span><span class="p">,</span><span class="n">content</span><span class="p">,</span><span class="n">Byconten</span> <span class="k">from</span> <span class="n">T_PRO_UNIT_STATUSBB</span><span class="o">@</span><span class="n">Gdsafetyah_237</span><span class="p">;</span><span class="cm">/*其它类型先插入*/</span>
 <span class="k">OPEN</span> <span class="n">bcur</span><span class="p">;</span>
 <span class="n">LOOP</span>
 <span class="k">FETCH</span> <span class="n">bcur</span> <span class="k">INTO</span> <span class="n">brec</span><span class="p">;</span>
 <span class="n">EXIT</span> <span class="k">WHEN</span> <span class="n">bcur</span><span class="o">%</span><span class="n">NOTFOUND</span><span class="p">;</span>
 <span class="k">update</span> <span class="n">T_PRO_UNIT_STATUSBB</span> <span class="k">set</span> <span class="n">BYCONTEN1</span><span class="o">=</span><span class="n">brec</span><span class="p">.</span><span class="n">BYCONTEN1</span> <span class="k">where</span> <span class="n">TIME_ID</span><span class="o">=</span><span class="n">brec</span><span class="p">.</span><span class="n">TIME_ID</span><span class="p">;</span><span class="cm">/*根据id更新long字段*/</span>
 <span class="k">END</span> <span class="n">LOOP</span><span class="p">;</span>
 <span class="k">CLOSE</span> <span class="n">bcur</span><span class="p">;</span>
 <span class="k">END</span><span class="p">;</span>
</code></pre></div>

      </section>
      
      <section class="comments">
        
          <a id="toggleComment" href="javascript:void(0);" onclick="showComment()">展开评论&gt;&gt;</a>
<script>
function showComment(){
    document.getElementById('disqus_thread').style.display='block';
    document.getElementById('toggleComment').innerHTML="&lt;&lt;收起评论";
    document.getElementById('toggleComment').setAttribute("onclick","hideComment()");
}
function hideComment(){
    document.getElementById('disqus_thread').style.display='none';
    document.getElementById('toggleComment').innerHTML="展开评论&gt;&gt;";
    document.getElementById('toggleComment').setAttribute("onclick","showComment()");
}
</script>
<div id="disqus_thread" style="display:none;"></div>
 <script type="text/javascript">
     /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
     var disqus_shortname = 'bianle'; // required: replace example with your forum shortname

     /* * * DON'T EDIT BELOW THIS LINE * * */
     (function () {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a style="display:none"  href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

        
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/bianle">bianle</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>

